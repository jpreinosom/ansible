---
- name: Mostrar el contenido de la llave privada y obtener información del servidor remoto
  hosts: local  # La máquina en la que se ejecuta el playbook
  gather_facts: no  # No es necesario recopilar hechos para esta tarea

  tasks:
    - name: Leer el contenido de la llave privada
      slurp:
        src: /home/ansible/.ssh/id_rsa  # Ruta de la llave privada en la máquina local
      register: private_key_content

    - name: Mostrar el contenido de la llave privada (decodificado)
      debug:
        msg: "{{ private_key_content.content | b64decode }}"

- name: Conectarse al servidor remoto y obtener información de la distribución
  hosts: 192.168.100.100  # Conexión al servidor remoto
  gather_facts: yes
  remote_user: webserver  # El usuario remoto
  ansible_ssh_private_key_file: /home/ansible/.ssh/id_rsa  # Ruta de la llave privada
  tasks:
    - name: Obtener la información de la distribución y versión del sistema operativo
      debug:
        msg: "Distribución: {{ ansible_facts['distribution'] }}, Versión: {{ ansible_facts['distribution_version'] }}"
